<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<title>Post Your Job</title>
<style>
    /* General body styling */
    body {
        font-family: 'Poppins', sans-serif;
        background-color: #f4f6f8;
        margin: 0;
        padding: 0;
    }

    /* Form container */
    .job-post-form {
        background-color: #fff;
        padding: 40px;
        max-width: 800px;
        margin: 50px auto;
        border-radius: 10px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    }

    /* Form heading */
    .job-post-form h2 {
        text-align: center;
        font-size: 28px;
        font-weight: 600;
        margin-bottom: 30px;
        color: #333;
        text-transform: uppercase;
        letter-spacing: 2px;
    }

    /* Form fields */
    .form-group {
        margin-bottom: 20px;
    }

    /* Labels */
    .form-group label {
        font-size: 16px;
        font-weight: 600;
        color: #333;
        display: block;
        margin-bottom: 8px;
        text-transform: uppercase;
    }

    /* Input fields */
    .form-group input[type="text"],
    .form-group input[type="time"],
    .form-group input[type="date"],
    .form-group select,
    .form-group textarea {
        width: 100%;
        padding: 12px;
        font-size: 16px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: #f9f9f9;
        color: #333;
        transition: border-color 0.3s ease;
    }

    .form-group input[type="text"]:focus,
    .form-group input[type="time"]:focus,
    .form-group select:focus,
    .form-group textarea:focus {
        border-color: #007bff;
        outline: none;
    }

    /* Textarea for description */
    .form-group textarea {
        height: 100px;
        resize: none;
    }

    /* Company dropdown */
    .form-group select {
        background-color: #fff;
    }

    /* Submit button */
    .submit-btn {
        width: 100%;
        padding: 15px;
        background-color: #007bff;
        color: #fff;
        font-size: 18px;
        font-weight: bold;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        text-transform: uppercase;
        letter-spacing: 1px;
        transition: background-color 0.3s ease;
    }

    .submit-btn:hover {
        background-color: #0056b3;
    }
</style>


<div class="job-post-form">
    <h2>Post a Job</h2>

    <!-- Job Title -->
    <div class="form-group">
        <label for="title">Job Title</label>
        <input type="text" id="title" name="title" placeholder="e.g., Application Developer" required>
    </div>

    <!-- Company Name -->
    <div class="form-group">
        <label for="company_posted_by">Company Posted By (Current User: {{ currentuser }})</label>
        <select id="company_posted_by" name="company_posted_by" required>
            {% for company in company_data %}
                <option value="{{ company.company_id }}">{{ company.company_name }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="form-group">
        <label for="reportsto">Reports To</label>
            {% for company in company_data %}
                <input type="text" value="{{ company.company_email }}" id="reportsto" readonly disabled>
            {% endfor %}
    </div>

    <!-- Job Location -->
    <div class="form-group">
        <label for="location">Job Location</label>
        <input type="text" id="location" name="location" placeholder="e.g., New York, NY" required>
    </div>

    <!-- Employment Type -->
    <div class="form-group">
        <label for="job_type">Job Type</label>
        <select id="job_type" name="job_type" required>
            <option value="FT">Full-time</option>
            <option value="PT">Part-time</option>
            <option value="CT">Contract</option>
            <option value="IN">Internship</option>
        </select>
    </div>

    <!-- Job Summary -->
    <div class="form-group">
        <label for="summary">Job Summary</label>
        <textarea id="summary" name="summary" placeholder="Brief summary of the job..." required></textarea>
    </div>

    <!-- Responsibilities -->
    <div class="form-group">
        <label for="responsibilities">Responsibilities</label>
        <textarea id="responsibilities" name="responsibilities" placeholder="Key responsibilities..." required></textarea>
    </div>

    <!-- Qualifications -->
    <div class="form-group">
        <label for="qualifications">Mandatory Qualifications</label>
        <textarea id="qualifications" name="qualifications" placeholder="Required qualifications..." required></textarea>
    </div>

    <!-- Preferred Qualifications -->
    <div class="form-group">
        <label for="preferred_qualifications">Preferred Qualifications (Optional)</label>
        <textarea id="preferred_qualifications" name="preferred_qualifications" placeholder="Preferred qualifications..."></textarea>
    </div>

    <!-- Skills -->
    <div class="form-group">
        <label for="skills">Skills Required</label>
        <input type="text" id="skills" name="skills" placeholder="e.g., JavaScript, Python, etc." required>
    </div>
    <div class="form-group">
        <label for="timings">Job Timings</label>
        <input type="text" id="timings" name="timings" placeholder="e.g.,8am - 5pm." required>
    </div>
    <div class="form-group">
        <label for="benefits">Job Benefits</label>
        <input type="text" id="benefits" name="benefits" placeholder="e.g.,Incentives, Bonus." required>
    </div>

    <!-- Salary (Optional) -->
    <div class="form-group">
        <label for="salary">Salary (Optional)</label>
        <input type="text" id="salary" name="salary" placeholder="Enter salary in decimal (e.g., 50000.00)">
    </div>
<!-- Category -->
<div class="form-group">
    <label for="category">Job Category</label>
    <select id="category" name="category" required>
        <!-- Options will be populated by AJAX -->
    </select>
</div>

<!-- Industry -->
<div class="form-group">
    <label for="industry">Industry</label>
    <select id="industry" name="industry" required>
        <option value="Tech">Technology</option>
        <option value="Health">Healthcare</option>
        <option value="Finance">Finance and Insurance</option>
        <option value="Retail">Retail</option>
        <option value="Manufacturing">Manufacturing</option>
        <option value="Construction">Construction</option>
        <option value="Education">Education</option>
        <option value="Transport">Transportation and Logistics</option>
        <option value="Hospitality">Hospitality and Tourism</option>
        <option value="Govt">Government</option>
        <option value="Telecom">Telecommunications</option>
        <option value="Energy">Energy and Utilities</option>
        <option value="Media">Media and Entertainment</option>
        <option value="Pharma">Pharmaceuticals</option>
        <option value="NonProfit">Non-profit Organizations</option>
        <option value="Agriculture">Agriculture</option>
        <option value="Consulting">Consulting</option>
        <option value="Legal">Legal Services</option>
        <option value="Fashion">Fashion</option>
        <option value="Automotive">Automotive</option>
    </select>
</div>

    <!-- Last Date to Apply -->
    <div class="form-group">
        <label for="last_date_to_apply">Last Date to Apply</label>
        <input type="date" id="last_date_to_apply" name="last_date_to_apply">
    </div>

    <!-- Submit Button -->
    <div class="form-group">
        <button type="submit" class="submit-btn" onclick="postJob()">Create Job</button>
    </div>
</div>



<script>
$(document).ready(function() {
    const YOUR_APP_ID = "9a012741";
    const YOUR_APP_KEY = "62640d675bd28172f530f7f4d7a792a6";

    $.ajax({
        type: "GET",
        url: `http://api.adzuna.com/v1/api/jobs/gb/categories?app_id=${YOUR_APP_ID}&app_key=${YOUR_APP_KEY}&&content-type=application/json`, // Use the correct endpoint for categories
        success: function(response) {
            console.log(response); // Inspect the response
            const categories = response.results; // Access the results array
            if (Array.isArray(categories)) {
                categories.forEach(function(category) {
                    $('#category').append(`<option value="${category.tag}">${category.label}</option>`); // Use 'tag' for value and 'label' for display
                });
            } else {
                console.error("Categories not found or not an array in response");
            }
        },
        error: function(xhr, status, error) {
            console.error("Failed to fetch categories:", error);
        }
    });
});


    function postJob(){
        const job_title = $("#title").val();
        const company_posted_by = $("#company_posted_by").val();
        const summary = $("#summary").val();
        const job_type = $("#job_type").val();
        const location = $("#location").val();
        const responsibilities = $("#responsibilities").val();
        const timings = $("#timings").val();
        const qualifications = $("#qualifications").val();
        const preferred_qualifications = $("#preferred_qualifications").val();
        const benefits = $("#benefits").val();
        const skills = $("#skills").val();
        const salary = $("#salary").val();
        const last_date_to_apply = $("#last_date_to_apply").val();
        const reportsto = $("#reportsto").val();
        const category = $("#category").val(); 
        const industry = $("#industry").val(); 
        $.ajax({
            type:"POST",
            url:"/new_job/",
            data:{
                "job_title":job_title,
                "company_posted_by":company_posted_by,
                "summary":summary,
                "job_type":job_type,
                "location":location,
                "responsibilities":responsibilities,
                "timings":timings,
                "qualifications":qualifications,
                "preferred_qualifications":preferred_qualifications,
                "skills":skills,
                "salary":salary,
                "benefits":benefits,
                "last_date_to_apply":last_date_to_apply,
                "reportsto":reportsto,
                "category": category,
                "industry": industry 
            },
            success:function(data){
                if(data){
                    alert("Success")
                    setTimeout(() => {
                        window.location.reload()
                    }, 2000);
                }
                else{
                    alert("Failed")
                }
            }
        })
    }
</script>