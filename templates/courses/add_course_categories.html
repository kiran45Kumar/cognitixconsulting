
{% extends 'adminuse/admin.html' %}
{% block navbar-sidebar %}
<head>
    <title>Add Category</title>
</head>
<style>
    .form{
        margin: 20px;
    }
.form label{
    font-size: 17px;
    font-weight: 300;
    margin: 10px 0;
    padding: 20px 0;
}

.form-class input{
    padding: 10px 100px;
    margin: 10px 0;
    outline: none;
    border: 1px solid #06d;
    border-radius: 5px;
}
.form-class textarea{
    outline: none;
    border: 1px solid #06d;
    border-radius: 5px;
    margin: 10px 0;
}
.form-class textarea::placeholder{
   padding: 5px 3px;
}
.form button{
    padding: 15px 45px;
    background: #06d;
    color: white;
    font-size: 1.12rem;
    border-radius: 5px;
}
#errorMessage{
    color: #dc3545;
    font-size: 19px;
    margin: 10px;
    padding: 10px;
}
#successMessage{
    color: #28a475;
    font-size: 19px;
    margin: 10px;
    padding: 10px;
}
.display_categories{
    display: flex;
    justify-content: space-evenly;
    align-items: center;
    flex-wrap: wrap;
}
.category1{
    width: 300px;
    height: 80px;
    box-shadow: 0px 3px 2px 3px silver;
    margin: 10px;
    display: flex;
    align-items: center;
    justify-content: space-between; 
    border-radius: 10px;   
}
.category1 p{
    margin: 10px;
    cursor: pointer;
}
.category1 span{
    margin: 10px;
    font-size: 30px;
    cursor: pointer;
}
</style>
<body>
    <div id="errorMessage" style="display:none;">There was an error creating the category.</div>
    <div id="successMessage" style="display:none;">Category successfully created!</div>

    <div class="form">
<div class="form-class">
    <label for="name">Category Name:</label><br>
    <input type="text" id="name" name="name" maxlength="100" placeholder="eg: Agile, Project, Programming. etc..." required><br><br>
</div>
<div class="form-class">
    <label for="description">Category Description (optional):</label><br>
    <textarea id="description" name="description" placeholder="eg: Brief on Category, its Scope" rows="4" cols="50"></textarea><br><br>
</div>
        <button onclick="createCategory()" id="btn">Submit</button>

    </div>

    <div class="display_categories">
        {% for category in categories %}
        <div class="category1">
            <p>{{category.name}}</p>
            <div class="cross"><span onclick="removeCat('{{category.id}}')">&times;</span></div>
        </div>
        {% endfor %}
    </div>
    <!-- Success Message -->
    
    <!-- Error Message -->
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>
        function removeCat(id) { 
            $.ajax(
            {
                type:"POST",
                url:"/delete_category/",
                data:{
                    "id":id,
                },
                success:function(data){
                    if(data['status'] == 'pass'){
                        $("#successMessage").show().text('Removed The Category')
                        setTimeout(() => {
                            window.location.reload()
                        }, 2000);
                    }
                    else {
                        $("#errorMessage").show().text("Failed to Remove the Category")
                    }
                }
            }
            )
         }
        function createCategory(){
            const name = $("#name").val();
            const description = $("#description").val();
            if(!name&&!description){
                $("#errorMessage").show();
                return;
            }
            else if(!name){
                $("#errorMessage").text("Please Enter Category Name!!");
                return;
            }
            $.ajax({
                type:"POST",
                url:"/create_category/",
                data:{
                    "name":name,
                    "description":description,
                },
                success:function(data){
                    if(data['status'] == 'pass'){
                        $("#successMessage").show()
                        
                        setTimeout(() => {
                          window.location.reload();  
                        },2000);
                    }
                    else if(data['status'] == 'fail'){
                        $("#errorMessage").show().html(data['message']);
                    }
                }
            })
        }
    </script>
</body>
{% endblock navbar-sidebar %}
